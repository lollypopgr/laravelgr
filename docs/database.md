# Βασική Χρήση Βάσεων Δεδομένων

- [Διαμόρφωση](#configuration)
- [Read / Write Συνδέσεις](#read-write-connections)
- [Εκτέλεση Queries](#running-queries)
- [Συνδιαλλαγές Βάσεων Δεδομένων](#database-transactions)
- [Πρόσβαση σε Συνδέσεις](#accessing-connections)
- [Καταγραφή των Queries](#query-logging)

<a name="configuration"></a>
## Διαμόρφωση

Το Laravel κάνει τη σύνδεση με βάσεις δεδομένων αλλά και την εκτέλεση queries μια εύκολη διαδικασία. Το αρχείο διαμόρφωσης της βάσης δεδομένων είναι το `app/config/database.php`. Σε αυτό το αρχείο μπορείτε να καθορίσετε όλες τις συνδέσεις της βάσης σας, καθώς επίσης και να καθορίσετε ποιά σύνδεση θα είναι η προεπιλεγμένη. Για όλες τις υποστηριζόμενες βάσεις δεδομένων παρέχονται παραδείγματα μέσα σε αυτό το αρχείο.

Προς το παρόν το Laravel υποστηρίζει τα παρακάτω συστήματα βάσεων δεδομένων: MySQL, Postgres, SQLite, και SQL Server.

<a name="read-write-connections"></a>
## Read / Write Συνδέσεις

Μερικές φορές μπορεί να επιθυμείτε μια σύνδεση βάσης δεδομένων για τη χρήση SELECT queries και κάποια άλλη σύνδεση για τη χρήση INSERT, UPDATE, και DELETE queries. Το Laravel το κάνει αυτό πολύ εύκολα είτε με τη χρήση raw queries, query builder, ή Eloquent ORM.

Για να καταλάβετε πώς πρέπει να διαμορφωθούν οι read / write συνδέσεις ρίξτε μια ματιά στο ακόλουθο παράδειγμα :

	'mysql' => array(
		'read' => array(
			'host' => '192.168.1.1',
		),
		'write' => array(
			'host' => '196.168.1.2'
		),
		'driver'    => 'mysql',
		'database'  => 'database',
		'username'  => 'root',
		'password'  => '',
		'charset'   => 'utf8',
		'collation' => 'utf8_unicode_ci',
		'prefix'    => '',
	),

Προσέξτε οτι έχουν προστεθεί δύο κλειδιά στον πίνακα διαμόρφωσης. Το κλειδί `read` και το κλειδί `write`. Και τα δύο κλειδιά έχουν τιμές πίνακα οι οποίες περιέχουν μόνο ένα κλειδί με όνομα `host`. Οι υπόλοιπες επιλογές για τη βάση δεδομένων των συνδέσεων `read` και `write` θα εφαρμοστούν με βάση τον κύριο `mysql` πίνακα. Επομένως το μόνο που χρειάζεται να κάνουμε είναι να προθέτουμε αντικείμενα-επιλογές στους πίνακες `read` και `write` αν θέλουμε να παρακάμψουμε τον κύριο πίνακα `mysql`. Έτσι, σε αυτήν την περίπτωση, η διεύθυνση `192.168.1.1` θα χρησιμοποιηθεί ως "read" σύνδεση, ενώ η διεύθυνση `192.168.1.2` θα χρησιμοποιηθεί ως "write" σύνδεση. Τα στοιχεία πιστοποίησης, το πρόθεμα, ο τύπος χαρακτήρων και όλες οι άλλες επιλογές στον κύριο πίνακα `mysql` θα χρησιμοποιηθούν και από τις δυο συνδέσεις.

<a name="running-queries"></a>
## Εκτέλεση Queries

Από τη στιγμή που έχετε διαμορφώσει τη σύνδεση με τη βάση δεδομένων, μπορείτε να εκτελείτε queries χρησιμοποιόντας την κλάση `DB`.

#### Εκτέλεση Select Query

	$results = DB::select('select * from users where id = ?', array(1));

Η μέθοδος `select` επιστρέφει πάντα έναν πίνακα αποτελεσμάτων.

#### Εκτέλεση Insert Statement

	DB::insert('insert into users (id, name) values (?, ?)', array(1, 'Dayle'));

#### Εκτέλεση Update Statement

	DB::update('update users set votes = 100 where name = ?', array('John'));

#### Εκτέλεση Delete Statement

	DB::delete('delete from users');

> **Σημείωση:** Τα statements `update` και `delete` επιστρέφουν τον αριθμό των σειρών που επηρεάστηκαν από τη συγκεκριμένη λειτουργία.

#### Εκτέλεση Γενικών Statements

	DB::statement('drop table users');

Μπορείτε να 'ακούσετε' query γεγονότα χρησιμοποιόντας την `DB::listen` μέθοδο:

#### 'Ακούγοντας' Query Γεγονότα

	DB::listen(function($sql, $bindings, $time)
	{
		//
	});

<a name="database-transactions"></a>
## Συνδιαλλαγές Βάσεων Δεδομένων

Για να εκτελέσετε ένα σύνολο λειτουργιών στο εσωτερικό μιας συνδιαλλαγής βάσης δεδομένων μπορείτε να χρησιμοποιήσετε τη μέθοδο `transaction`:

	DB::transaction(function()
	{
		DB::table('users')->update(array('votes' => 1));

		DB::table('posts')->delete();
	});

> **Σημείωση:** Αν συμβεί οποιαδήποτε εξαίρεση μέσα στo `transaction` closure θα προκαλέσει αυτόματη επαναφορά σε προτέρα κατάσταση.

Κάποιες φορές μπορεί να χρειαστεί να ξεκινήσετε εσείς μια συνδιαλλαγή βάσης δεδομένων:

	DB::beginTransaction();

Μπορείτε να επαναφέρετε τη συνδιαλλαγή σε προτέρα κατάσταση μέσω της μεθόδου `rollback` :

	DB::rollback();

Τέλος, μπορείτε να πραγματοποιήσετε μια συνδιαλλαγή με τη χρήση της μεθόδου `commit` :

	DB::commit();

<a name="accessing-connections"></a>
## Πρόσβαση σε Συνδέσεις

Όταν χρησιμοποιείτε πολλαπλές συνδέσεις μπορείτε να αποκτήσετε πρόσβαση σε αυτές μέσω της μεθόδου `DB::connection` :

	$users = DB::connection('foo')->select(...);

Μπορείτε επίσης να αποκτήσετε πρόσβαση στο 'καθαρό', PDO στιγμιότυπο:

	$pdo = DB::connection()->getPdo();

Κάποιες φορές μπορεί να επιθυμείτε να κάνετε επανασύνδεση σε κάποια βάση δεδομένων:

	DB::reconnect('foo');

Αν χρειάζεται να αποσυνδεθείτε από μια βάση δεδομένων εξ' αιτίας της υπέρβασης του ορίου `max_connections` από το PDO στιγμιότυπο, χρησιμοποιήστε τη μέθοδο `disconnect` :

	DB::disconnect('foo');

<a name="query-logging"></a>
## Καταγραφή των Queries

Από προεπιλογή, το Laravel κρατάει ένα αρχείο καταγραφής στη μνήμη για όλα τα queries που έχουν εκτελεστεί απο το τρέχον αίτημα (request) της εφαρμογής σας. Ωστόσο σε μερικές περιπτώσεις, όπως η εισαγωγή πολλών σειρών στη βάση δεδομένων, αυτό μπορεί να προκαλέσει υπέρβαση μνήμης από την εφαρμογή. Για να απενεργοποιήσετε το αρχείο καταγραφής μπορείτε να χρησιμοποιήσετε τη μέθοδο `disableQueryLog` :

	DB::connection()->disableQueryLog();

Για να πάρετε έναν πίνακα από τα queries που έχουν εκτελεστεί, μπορείτε να χρησιμοποιήσετε τη μέθοδο `getQueryLog` :

       $queries = DB::getQueryLog();
